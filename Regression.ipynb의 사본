{"cells":[{"cell_type":"markdown","metadata":{"id":"uadWszFL8KYt"},"source":["### Logistic Regression"]},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":1026,"status":"ok","timestamp":1653608689203,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"pAPVJtlC8KYv"},"outputs":[],"source":["from sklearn.preprocessing import StandardScaler\n","scaler = StandardScaler()\n","from sklearn.preprocessing import KBinsDiscretizer\n","discretizer = KBinsDiscretizer()"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":558,"status":"ok","timestamp":1653608805994,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"-_gX1k868KYw"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","df_processed = pd.read_csv(\"/content/df_merged2.csv\")\n","\n","import re\n","def reprocess(text):\n","    return re.sub(r'[^\\s\\d\\w]','',text).split(' ')\n","df_processed['title_new'] = df_processed['title_new'].apply(reprocess)"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":276},"executionInfo":{"elapsed":390,"status":"ok","timestamp":1653608808984,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"kBMFAfS18KYw","outputId":"43f6a75e-a157-4e70-f3f6-5a9af7e465d6","scrolled":true},"outputs":[{"data":{"image/png":"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\n","text/plain":["\u003cFigure size 432x288 with 1 Axes\u003e"]},"metadata":{},"output_type":"display_data"}],"source":["import matplotlib.pyplot as plt\n","plt.plot(df_processed['views'])\n","plt.show()"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1653608810053,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"CDnawR1U8KYx"},"outputs":[],"source":["n1 = df_processed['views'].describe()['25%']\n","n2 = df_processed['views'].describe()['50%']\n","n3 = df_processed['views'].describe()['75%']"]},{"cell_type":"code","execution_count":6,"metadata":{"executionInfo":{"elapsed":1,"status":"ok","timestamp":1653608811301,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"bOmKrtEY8KYx"},"outputs":[],"source":["### preprocess views-levels\n","def ViewPreproc2(data):\n","    if data \u003c= n1:\n","        label = 0\n","    elif n1 \u003c data \u003c= n2:\n","        label = 1\n","    elif n2 \u003c data \u003c= n3:\n","        label = 2\n","    elif data \u003e n3:\n","        label = 3\n","    return label\n","\n","df_viewlv = []\n","for view in df_processed['views']:\n","    label = ViewPreproc2(view)\n","    df_viewlv.append(label)\n","df_processed['view_lv'] = df_viewlv"]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1653608813153,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"O4FLwqqM8KYx"},"outputs":[],"source":["from sklearn.preprocessing import LabelEncoder\n","le = LabelEncoder()\n","df_processed['emoji_label'] = le.fit_transform(df_processed['emoji'])"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":485},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1653608813696,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"oXxDLLGG8KYy","outputId":"620c6fb2-1781-4aca-e306-09ca71ea90a3","scrolled":false},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-dd63d408-4c63-4e59-8584-a0371c9d6e15\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003elabel\u003c/th\u003e\n","      \u003cth\u003etitle_new\u003c/th\u003e\n","      \u003cth\u003eemoji\u003c/th\u003e\n","      \u003cth\u003eviews\u003c/th\u003e\n","      \u003cth\u003esubs\u003c/th\u003e\n","      \u003cth\u003echannel_name\u003c/th\u003e\n","      \u003cth\u003eview_lv\u003c/th\u003e\n","      \u003cth\u003eemoji_label\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e804394.0\u003c/td\u003e\n","      \u003ctd\u003e1960000.0\u003c/td\u003e\n","      \u003ctd\u003e고몽\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[할인, 뷰마, 박스, 공개]\u003c/td\u003e\n","      \u003ctd\u003eTrue\u003c/td\u003e\n","      \u003ctd\u003e199959.0\u003c/td\u003e\n","      \u003ctd\u003e352000.0\u003c/td\u003e\n","      \u003ctd\u003e뷰티마우스\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e61394.0\u003c/td\u003e\n","      \u003ctd\u003e159000.0\u003c/td\u003e\n","      \u003ctd\u003e옥뷰티 OK Beauty\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[배우, 잠적, 이유, 뷰티, 사이드, 요약]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e7568.0\u003c/td\u003e\n","      \u003ctd\u003e250000.0\u003c/td\u003e\n","      \u003ctd\u003eDRAMA Voyage\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e193907.0\u003c/td\u003e\n","      \u003ctd\u003e133000.0\u003c/td\u003e\n","      \u003ctd\u003e뷰티숨BEAUTYSOOM\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26737\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[아줌마, 브이, 로그, 주부, 일상, 네일아트]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e93572.0\u003c/td\u003e\n","      \u003ctd\u003e102000.0\u003c/td\u003e\n","      \u003ctd\u003e양아치TV AUNT TV\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26738\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e1208.0\u003c/td\u003e\n","      \u003ctd\u003e522.0\u003c/td\u003e\n","      \u003ctd\u003e예슬 Serena\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26739\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e950.0\u003c/td\u003e\n","      \u003ctd\u003e522.0\u003c/td\u003e\n","      \u003ctd\u003e예슬 Serena\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26740\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e162171.0\u003c/td\u003e\n","      \u003ctd\u003e1070000.0\u003c/td\u003e\n","      \u003ctd\u003eTesla US\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26741\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e945.0\u003c/td\u003e\n","      \u003ctd\u003e522.0\u003c/td\u003e\n","      \u003ctd\u003e예슬 Serena\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e26742 rows × 8 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dd63d408-4c63-4e59-8584-a0371c9d6e15')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-dd63d408-4c63-4e59-8584-a0371c9d6e15 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dd63d408-4c63-4e59-8584-a0371c9d6e15');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["       label                                          title_new  emoji  \\\n","0          0            [사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]  False   \n","1          0                                   [할인, 뷰마, 박스, 공개]   True   \n","2          0          [요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]  False   \n","3          0                          [배우, 잠적, 이유, 뷰티, 사이드, 요약]  False   \n","4          0  [청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...  False   \n","...      ...                                                ...    ...   \n","26737      4                        [아줌마, 브이, 로그, 주부, 일상, 네일아트]  False   \n","26738      4  [미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...  False   \n","26739      4  [미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...  False   \n","26740      4                                                 []  False   \n","26741      4                      [미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]  False   \n","\n","          views       subs   channel_name  view_lv  emoji_label  \n","0      804394.0  1960000.0             고몽        3            0  \n","1      199959.0   352000.0          뷰티마우스        2            1  \n","2       61394.0   159000.0  옥뷰티 OK Beauty        2            0  \n","3        7568.0   250000.0   DRAMA Voyage        1            0  \n","4      193907.0   133000.0  뷰티숨BEAUTYSOOM        2            0  \n","...         ...        ...            ...      ...          ...  \n","26737   93572.0   102000.0  양아치TV AUNT TV        2            0  \n","26738    1208.0      522.0      예슬 Serena        0            0  \n","26739     950.0      522.0      예슬 Serena        0            0  \n","26740  162171.0  1070000.0       Tesla US        2            0  \n","26741     945.0      522.0      예슬 Serena        0            0  \n","\n","[26742 rows x 8 columns]"]},"metadata":{},"output_type":"display_data"}],"source":["display(df_processed)"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":676},"executionInfo":{"elapsed":387,"status":"ok","timestamp":1653608817078,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"VciLpLkB8KYy","outputId":"43c72dc5-4061-4bf7-92fc-971f692ce12d"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-0b765ccb-5668-4823-afa8-b12ccb52aea5\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003elabel\u003c/th\u003e\n","      \u003cth\u003etitle_new\u003c/th\u003e\n","      \u003cth\u003eemoji\u003c/th\u003e\n","      \u003cth\u003eviews\u003c/th\u003e\n","      \u003cth\u003esubs\u003c/th\u003e\n","      \u003cth\u003echannel_name\u003c/th\u003e\n","      \u003cth\u003eview_lv\u003c/th\u003e\n","      \u003cth\u003eemoji_label\u003c/th\u003e\n","      \u003cth\u003etitle_str\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e804394.0\u003c/td\u003e\n","      \u003ctd\u003e1960000.0\u003c/td\u003e\n","      \u003ctd\u003e고몽\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e사람 번만 사람 레전드 꿀잼 드라마 뷰티 사이드 보기\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[할인, 뷰마, 박스, 공개]\u003c/td\u003e\n","      \u003ctd\u003eTrue\u003c/td\u003e\n","      \u003ctd\u003e199959.0\u003c/td\u003e\n","      \u003ctd\u003e352000.0\u003c/td\u003e\n","      \u003ctd\u003e뷰티마우스\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e할인 뷰마 박스 공개\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e61394.0\u003c/td\u003e\n","      \u003ctd\u003e159000.0\u003c/td\u003e\n","      \u003ctd\u003e옥뷰티 OK Beauty\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e요즘 프로필 메이크업 연예인 프로필 메이크업 역대 메이크업\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[배우, 잠적, 이유, 뷰티, 사이드, 요약]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e7568.0\u003c/td\u003e\n","      \u003ctd\u003e250000.0\u003c/td\u003e\n","      \u003ctd\u003eDRAMA Voyage\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e배우 잠적 이유 뷰티 사이드 요약\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e[청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e193907.0\u003c/td\u003e\n","      \u003ctd\u003e133000.0\u003c/td\u003e\n","      \u003ctd\u003e뷰티숨BEAUTYSOOM\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e청담동 메이크업 추천 그대로 구매 지속 파운데이션 가닥 속눈썹 고급 하이 라이터 웨...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26737\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[아줌마, 브이, 로그, 주부, 일상, 네일아트]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e93572.0\u003c/td\u003e\n","      \u003ctd\u003e102000.0\u003c/td\u003e\n","      \u003ctd\u003e양아치TV AUNT TV\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e아줌마 브이 로그 주부 일상 네일아트\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26738\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e1208.0\u003c/td\u003e\n","      \u003ctd\u003e522.0\u003c/td\u003e\n","      \u003ctd\u003e예슬 Serena\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e미국 유학생 일상 브이 로그 학교 브이 로그 코딩 수업 학교 스킨 케어\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26739\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e950.0\u003c/td\u003e\n","      \u003ctd\u003e522.0\u003c/td\u003e\n","      \u003ctd\u003e예슬 Serena\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e미국 유학생 일상 브이 로그 주말 브이 로그 요리 해먹 마트 일상 마스크 마트 중국...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26740\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e162171.0\u003c/td\u003e\n","      \u003ctd\u003e1070000.0\u003c/td\u003e\n","      \u003ctd\u003eTesla US\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e26741\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e[미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]\u003c/td\u003e\n","      \u003ctd\u003eFalse\u003c/td\u003e\n","      \u003ctd\u003e945.0\u003c/td\u003e\n","      \u003ctd\u003e522.0\u003c/td\u003e\n","      \u003ctd\u003e예슬 Serena\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e미국 미대 크리 겟레디윗미 프라이탁 불시\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e26742 rows × 9 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0b765ccb-5668-4823-afa8-b12ccb52aea5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-0b765ccb-5668-4823-afa8-b12ccb52aea5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0b765ccb-5668-4823-afa8-b12ccb52aea5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["       label                                          title_new  emoji  \\\n","0          0            [사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]  False   \n","1          0                                   [할인, 뷰마, 박스, 공개]   True   \n","2          0          [요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]  False   \n","3          0                          [배우, 잠적, 이유, 뷰티, 사이드, 요약]  False   \n","4          0  [청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...  False   \n","...      ...                                                ...    ...   \n","26737      4                        [아줌마, 브이, 로그, 주부, 일상, 네일아트]  False   \n","26738      4  [미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...  False   \n","26739      4  [미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...  False   \n","26740      4                                                 []  False   \n","26741      4                      [미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]  False   \n","\n","          views       subs   channel_name  view_lv  emoji_label  \\\n","0      804394.0  1960000.0             고몽        3            0   \n","1      199959.0   352000.0          뷰티마우스        2            1   \n","2       61394.0   159000.0  옥뷰티 OK Beauty        2            0   \n","3        7568.0   250000.0   DRAMA Voyage        1            0   \n","4      193907.0   133000.0  뷰티숨BEAUTYSOOM        2            0   \n","...         ...        ...            ...      ...          ...   \n","26737   93572.0   102000.0  양아치TV AUNT TV        2            0   \n","26738    1208.0      522.0      예슬 Serena        0            0   \n","26739     950.0      522.0      예슬 Serena        0            0   \n","26740  162171.0  1070000.0       Tesla US        2            0   \n","26741     945.0      522.0      예슬 Serena        0            0   \n","\n","                                               title_str  \n","0                          사람 번만 사람 레전드 꿀잼 드라마 뷰티 사이드 보기  \n","1                                            할인 뷰마 박스 공개  \n","2                       요즘 프로필 메이크업 연예인 프로필 메이크업 역대 메이크업  \n","3                                     배우 잠적 이유 뷰티 사이드 요약  \n","4      청담동 메이크업 추천 그대로 구매 지속 파운데이션 가닥 속눈썹 고급 하이 라이터 웨...  \n","...                                                  ...  \n","26737                               아줌마 브이 로그 주부 일상 네일아트  \n","26738            미국 유학생 일상 브이 로그 학교 브이 로그 코딩 수업 학교 스킨 케어  \n","26739  미국 유학생 일상 브이 로그 주말 브이 로그 요리 해먹 마트 일상 마스크 마트 중국...  \n","26740                                                     \n","26741                             미국 미대 크리 겟레디윗미 프라이탁 불시  \n","\n","[26742 rows x 9 columns]"]},"metadata":{},"output_type":"display_data"}],"source":["from sklearn.feature_extraction.text import CountVectorizer # frequency based DTM\n","from sklearn.feature_extraction.text import TfidfVectorizer # tf-idf based DTM\n","\n","### make data to list of strings again\n","title_filtered = []\n","for title in df_processed['title_new']:\n","    title_str =' '.join(title)\n","    title_filtered.append(title_str) # list of docs, doc 은 단어들로 구성이 된 string data\n","# 불필요한 단어들을 제거하고 난후 DTM로 변환하기 위해 다시 list of strings의 형태로 변환\n","df_processed['title_str']=title_filtered\n","display(df_processed)"]},{"cell_type":"markdown","metadata":{"id":"cSW618GM8KYy"},"source":["### Vectorization ver 1."]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1418,"status":"ok","timestamp":1653608822919,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"QGuq3U-g8KYz","outputId":"a921ba6d-1018-46b4-974f-d7d584669301"},"outputs":[{"data":{"text/plain":["(26742, 1500)"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["tfidf_vectorizer2 = TfidfVectorizer(min_df=1, ngram_range=(1,2), max_features = 1500)\n","tfidf_features2 = tfidf_vectorizer2.fit_transform(df_processed['title_str'])\n","tfidf_features2 = np.array(tfidf_features2.todense())\n","tfidf_features2.shape"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":526,"status":"ok","timestamp":1653608824876,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"hYMS7qJC8KYz"},"outputs":[],"source":["tfidf2 = pd.DataFrame(tfidf_features2)\n","X = pd.concat([tfidf2, df_processed[['subs','emoji_label']]], axis = 1)\n","y = df_processed['view_lv']"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":395,"status":"ok","timestamp":1653608825792,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"nCUx_0448KYz","outputId":"60043bf6-10d1-4aff-b4eb-cb6410b2316f"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n","/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n"]}],"source":["from sklearn.preprocessing import MaxAbsScaler\n","max_scaler = MaxAbsScaler()\n","\n","X_sc = max_scaler.fit_transform(X)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":357,"status":"ok","timestamp":1653553197692,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"ionlj6V48KYz","outputId":"c81678e8-3307-43c9-9794-deac3b200fc5"},"outputs":[{"data":{"text/plain":["array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 1.00512821e-01, 0.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 1.80512821e-02, 1.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 8.15384615e-03, 0.00000000e+00],\n","       ...,\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 2.67692308e-05, 0.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 5.48717949e-02, 0.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 2.67692308e-05, 0.00000000e+00]])"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["X_sc"]},{"cell_type":"code","execution_count":13,"metadata":{"executionInfo":{"elapsed":1319,"status":"ok","timestamp":1653608832780,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"0Sx3MOcZ8KYz"},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","X_train, X_test, y_train, y_test = train_test_split(X_sc, y, \n","                                                    test_size=0.2, \n","                                                    random_state=0, \n","                                                    stratify=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8_6v1qQC8KYz"},"outputs":[],"source":["from sklearn.naive_bayes import GaussianNB\n","from sklearn.metrics import accuracy_score\n","\n","gnb = GaussianNB()\n","gnb.fit(X_train, y_train)\n","y_gnb = gnb.predict(X_test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":355,"status":"ok","timestamp":1653573285253,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"MPHoJ4Uq8KY0","outputId":"001830ba-7169-4105-bdbe-3450be66ac10"},"outputs":[{"data":{"text/plain":["0.4484950458029538"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["accuracy_score(y_test, y_gnb)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":23920,"status":"ok","timestamp":1653573312832,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"0n4Fqmej8KY0","outputId":"a72aa73e-a57f-4d1d-b246-c0a205369a46"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,\n"]},{"data":{"text/plain":["0.5767433165077585"]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.linear_model import LogisticRegression\n","lr1 = LogisticRegression()\n","lr1.fit(X_train, y_train)\n","y_lr1 = lr1.predict(X_test)\n","\n","accuracy_score(y_test, y_lr1)"]},{"cell_type":"markdown","metadata":{"id":"eDvCkpk9dGld"},"source":["logistic에서는 std scaling이 더 좋은 퍼포를 보임 역시나"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13077,"status":"ok","timestamp":1653573331727,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"wOdJl1t28KY0","outputId":"20288681-122f-4be4-adf2-29a1d5ae21ec"},"outputs":[{"data":{"text/plain":["0.5485137408861469"]},"execution_count":16,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.neighbors import KNeighborsClassifier\n","\n","knn = KNeighborsClassifier()\n","knn.fit(X_train, y_train)\n","y_knn = knn.predict(X_test)\n","accuracy_score(y_test, y_knn)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6103,"status":"ok","timestamp":1653573342891,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"TKa7moZ08KY0","outputId":"20273895-2d00-4dee-e071-ac5c442f119a"},"outputs":[{"data":{"text/plain":["0.6926528323051038"]},"execution_count":17,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.tree import DecisionTreeClassifier\n","dt = DecisionTreeClassifier()\n","dt.fit(X_train, y_train)\n","y_dt = dt.predict(X_test)\n","accuracy_score(y_test, y_dt)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2pRW_Uco8KY0"},"outputs":[],"source":["from sklearn.svm import SVC\n","svc1 = SVC(kernel='rbf', gamma='auto', C=0.1)\n","svc1.fit(X_train, y_train)\n","y_svc1 = svc1.predict(X_test)\n","accuracy_score(y_test, y_svc1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":177649,"status":"ok","timestamp":1653553560927,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"_eSP4CVYaekv","outputId":"5ebc9cd6-6b42-4ccd-ae6e-b68a0fc16ea9"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/joblib/externals/loky/process_executor.py:705: UserWarning: A worker stopped while some jobs were given to the executor. This can be caused by a too short worker timeout or by a memory leak.\n","  \"timeout or by a memory leak.\", UserWarning\n"]},{"data":{"text/plain":["0.30772106935875865"]},"execution_count":20,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.ensemble import BaggingClassifier\n","bag_dt = BaggingClassifier(KNeighborsClassifier(), n_estimators=1000,\n","                           max_samples=100, bootstrap=True, n_jobs=-1)\n","bag_dt.fit(X_train, y_train)\n","y_bag_dt = bag_dt.predict(X_test)\n","accuracy_score(y_test, y_bag_dt)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14829,"status":"ok","timestamp":1653573374893,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"X77T_4HxbHWa","outputId":"54ee7193-7d69-4ee0-f719-691f41b6a1f5"},"outputs":[{"data":{"text/plain":["0.7193868012712656"]},"execution_count":18,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.ensemble import RandomForestClassifier\n","rnd_clf = RandomForestClassifier(n_estimators=50, max_features='sqrt', \n","                                 max_depth = None, min_samples_split=2,\n","                                 n_jobs=-1)\n","rnd_clf.fit(X_train, y_train)\n","y_rnd = rnd_clf.predict(X_test)\n","accuracy_score(y_test, y_rnd)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":28352,"status":"ok","timestamp":1653573408237,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"2Yby-jhpeuFL","outputId":"6be5195e-efe7-4e89-e4a0-4fd55d1b72c7"},"outputs":[{"data":{"text/plain":["0.71695644045616"]},"execution_count":19,"metadata":{},"output_type":"execute_result"}],"source":["rnd_clf2 = RandomForestClassifier(n_estimators=100, max_features='sqrt', \n","                                 max_depth = None, min_samples_split=2,\n","                                 n_jobs=-1)\n","rnd_clf2.fit(X_train, y_train)\n","y_rnd2 = rnd_clf2.predict(X_test)\n","accuracy_score(y_test, y_rnd2)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":276939,"status":"ok","timestamp":1653573697481,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"EBJ-AGqciQmK","outputId":"36a67779-703b-4be8-ccc9-2f2f643e3640"},"outputs":[{"data":{"text/plain":["0.7206954570947841"]},"execution_count":20,"metadata":{},"output_type":"execute_result"}],"source":["rnd_clf4 = RandomForestClassifier(n_estimators=1000, max_features='sqrt', \n","                                 max_depth = None, min_samples_split=2,\n","                                 n_jobs=-1)\n","rnd_clf4.fit(X_train, y_train)\n","y_rnd4 = rnd_clf4.predict(X_test)\n","accuracy_score(y_test, y_rnd4)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":40810,"status":"ok","timestamp":1653573749035,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"b32xxO9rfFNz","outputId":"a771b7f8-8ecc-46d1-914b-31eb6ebab9f3"},"outputs":[{"data":{"text/plain":["0.694709291456347"]},"execution_count":21,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.ensemble import ExtraTreesClassifier\n","ext_clf = ExtraTreesClassifier(n_estimators=50,\n","                                 max_features='sqrt', max_depth = None,\n","                                 n_jobs=-1)\n","ext_clf.fit(X_train, y_train)\n","y_ext = ext_clf.predict(X_test)\n","accuracy_score(y_test, y_ext)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":325,"status":"ok","timestamp":1653573848715,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"NIxEiS8ordmI","outputId":"d5219d92-e3d4-46c3-cba5-3d19bdeb9aa9"},"outputs":[{"data":{"text/plain":["0.6886612387810623"]},"execution_count":23,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.metrics import r2_score\n","r2_score(y_test, y_rnd4)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":252146,"status":"ok","timestamp":1653574240588,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"w1CUPTTGr0JK","outputId":"fbfb7c96-3a4d-469e-a1b6-bc2f684fa5a4"},"outputs":[{"data":{"text/plain":["0.695644045616003"]},"execution_count":24,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.ensemble import AdaBoostClassifier\n","ada_clf = AdaBoostClassifier(DecisionTreeClassifier(), n_estimators = 100)\n","ada_clf.fit(X_train, y_train)\n","y_ada = ada_clf.predict(X_test)\n","accuracy_score(y_test, y_ada)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":486,"status":"ok","timestamp":1653574709100,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"dSVMLSn1u4jA","outputId":"a2d1eaba-2ec1-4b97-a527-392fc47c22dd"},"outputs":[{"data":{"text/plain":["0.6427529776407099"]},"execution_count":25,"metadata":{},"output_type":"execute_result"}],"source":["r2_score(y_test, y_ada)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"X6ZDodT_uYqr"},"outputs":[{"ename":"NameError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m\u003cipython-input-14-3e75d97e20b4\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0mgb_clf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_train\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m \u001b[0my_gb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgb_clf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 11\u001b[0;31m \u001b[0maccuracy_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_gb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'accuracy_score' is not defined"]}],"source":["from sklearn.ensemble import GradientBoostingClassifier\n","params = {\n","    \"n_estimators\": 500,\n","    \"max_depth\": 4,\n","    \"min_samples_split\": 5,\n","    \"learning_rate\": 0.01,\n","}\n","gb_clf = GradientBoostingClassifier(**params)\n","gb_clf.fit(X_train, y_train)\n","y_gb = gb_clf.predict(X_test)\n","accuracy_score(y_test, y_gb)"]},{"cell_type":"markdown","metadata":{"id":"jNqz-zA_ceSR"},"source":[""]},{"cell_type":"markdown","metadata":{"id":"uFvlbkHo8KY0"},"source":["### Vectorization ver2."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"k8wjMcbh8KY0"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1831,"status":"ok","timestamp":1653554329565,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"OPUybVC28KY1","outputId":"2ef4a959-f851-4954-da69-d54802598ddd"},"outputs":[{"data":{"text/plain":["(26742, 1000)"]},"execution_count":28,"metadata":{},"output_type":"execute_result"}],"source":["tfidf_vectorizer = TfidfVectorizer(min_df=1, ngram_range=(1,2), max_features = 1000)\n","tfidf_features = tfidf_vectorizer.fit_transform(df_processed['title_str'])\n","tfidf_features = np.array(tfidf_features.todense())\n","tfidf_features.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7pRh_f9k8KY1"},"outputs":[],"source":["tfidf = pd.DataFrame(tfidf_features)\n","X2 = pd.concat([tfidf, df_processed[['subs','emoji_label']]], axis = 1)\n","y = df_processed['view_lv']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3401,"status":"ok","timestamp":1653554352126,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"pfSQ0sii8KY1","outputId":"a8a2c39c-41ca-45f6-f545-4dac35066b83"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n","/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n","/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n","/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n"]}],"source":["X_sc2 = scaler.fit_transform(X2)\n","\n","from sklearn.preprocessing import MaxAbsScaler\n","max_scaler = MaxAbsScaler()\n","X_sc3 = max_scaler.fit_transform(X2)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":354,"status":"ok","timestamp":1653554360527,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"r_J8racl8KY1","outputId":"7b10b039-67d5-4116-e4b3-70b617694d8a"},"outputs":[{"data":{"text/plain":["array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 1.00512821e-01, 0.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 1.80512821e-02, 1.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 8.15384615e-03, 0.00000000e+00],\n","       ...,\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 2.67692308e-05, 0.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 5.48717949e-02, 0.00000000e+00],\n","       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,\n","        0.00000000e+00, 2.67692308e-05, 0.00000000e+00]])"]},"execution_count":33,"metadata":{},"output_type":"execute_result"}],"source":["X_sc3"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dDEY0Eco8KY1"},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","X_train2, X_test2, y_train2, y_test2 = train_test_split(X_sc2, y, \n","                                                    test_size=0.2, \n","                                                    random_state=0, \n","                                                    stratify=y)\n","X_train3, X_test3, y_train3, y_test3 = train_test_split(X_sc3, y, \n","                                                    test_size=0.2, \n","                                                    random_state=0, \n","                                                    stratify=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":948,"status":"ok","timestamp":1653554385438,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"7exq4O-F8KY1","outputId":"460c9bf4-7ed4-423d-feff-8ed09aeb13d9"},"outputs":[{"data":{"text/plain":["0.4524210132735091"]},"execution_count":35,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.naive_bayes import GaussianNB\n","from sklearn.metrics import accuracy_score\n","\n","gnb2 = GaussianNB()\n","gnb2.fit(X_train2, y_train2)\n","y_gnb2 = gnb2.predict(X_test2)\n","accuracy_score(y_test2, y_gnb2)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17608,"status":"ok","timestamp":1653554420513,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"qpi5q8JL8KY1","outputId":"d007170b-bbe7-44e7-8fb9-f4fd61653ea1"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,\n"]},{"data":{"text/plain":["0.5737521031968592"]},"execution_count":36,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.linear_model import LogisticRegression\n","lr2 = LogisticRegression()\n","lr2.fit(X_train2, y_train2)\n","y_lr2 = lr2.predict(X_test2)\n","\n","accuracy_score(y_test2, y_lr2)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5391,"status":"ok","timestamp":1653554457684,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"sd40uk5f8KY1","outputId":"8b0b90e6-6754-4275-adc4-8a328e17ebf0"},"outputs":[{"data":{"text/plain":["0.6866704056833053"]},"execution_count":37,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.tree import DecisionTreeClassifier\n","dt2 = DecisionTreeClassifier()\n","dt2.fit(X_train2, y_train2)\n","y_dt2 = dt2.predict(X_test2)\n","accuracy_score(y_test2, y_dt2)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4618,"status":"ok","timestamp":1653554467324,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"3IcWQ6dt8KY1","outputId":"184cb6e1-0763-4b63-86ad-9e11d37d8336"},"outputs":[{"data":{"text/plain":["0.6879790615068238"]},"execution_count":38,"metadata":{},"output_type":"execute_result"}],"source":["dt3 = DecisionTreeClassifier()\n","dt3.fit(X_train3, y_train3)\n","y_dt3 = dt3.predict(X_test3)\n","accuracy_score(y_test3, y_dt3)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":28643,"status":"ok","timestamp":1653554543073,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"0J8iBV96hzXb","outputId":"9c41d9c3-cd73-4d24-8102-6bc635e83dac"},"outputs":[{"data":{"text/plain":["0.7210693587586465"]},"execution_count":39,"metadata":{},"output_type":"execute_result"}],"source":["rnd_clf3 = RandomForestClassifier(n_estimators=100, max_features='sqrt', \n","                                 max_depth = None, min_samples_split=2,\n","                                 n_jobs=-1)\n","rnd_clf3.fit(X_train3, y_train3)\n","y_rnd3 = rnd_clf3.predict(X_test3)\n","accuracy_score(y_test3, y_rnd3)"]},{"cell_type":"markdown","metadata":{"id":"csFYkVba8KY1"},"source":["### 0526 깨달음\n","- scaling : max\n","- sparse matrix compression 더 연구, 1500 이 500 보다는 나은것같음\n","- decision tree 가 성능이 젤 나음 //로지스틱은 너무 연산량이 많은가봄.. 페널티 텀이랑 이런거 넣어서 튜닝 필요"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"C4Qx6i-b8KY2"},"outputs":[],"source":["from sklearn.linear_model import LogisticRegression\n","lr3 = LogisticRegression(penalty='l1')\n","lr3.fit(X_train3, y_train3)\n","y_lr3 = lr3.predict(X_test3)\n","\n","accuracy_score(y_test3, y_lr3)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iqY7NCw58KY2"},"outputs":[],"source":[""]}],"metadata":{"colab":{"name":"Regression.ipynb의 사본","provenance":[{"file_id":"1-ES2QbZdHCvrCjSQTiTux694qGPsNDfY","timestamp":1653573134549}],"version":""},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"}},"nbformat":4,"nbformat_minor":0}