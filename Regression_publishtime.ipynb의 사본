{"cells":[{"cell_type":"markdown","metadata":{"id":"uadWszFL8KYt"},"source":["### Logistic Regression"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":58633,"status":"ok","timestamp":1654311805605,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"YJ_kvOA0QErG","outputId":"f6c87892-1ec1-4c2c-b7be-11119d060fa0"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"pAPVJtlC8KYv","executionInfo":{"status":"ok","timestamp":1654311825308,"user_tz":-540,"elapsed":893,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["from sklearn.preprocessing import StandardScaler\n","scaler = StandardScaler()\n","from sklearn.preprocessing import KBinsDiscretizer\n","discretizer = KBinsDiscretizer()"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"-_gX1k868KYw","executionInfo":{"status":"ok","timestamp":1654311828824,"user_tz":-540,"elapsed":2240,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","df_processed = pd.read_csv(\"/content/drive/Shareddrives/응머러러/df_merged_new.csv\")\n","\n","import re\n","def reprocess(text):\n","    return re.sub(r'[^\\s\\d\\w]','',text).split(' ')\n","df_processed['title_new'] = df_processed['title_new'].apply(reprocess)"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":276},"executionInfo":{"elapsed":586,"status":"ok","timestamp":1654311831296,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"kBMFAfS18KYw","outputId":"430f1e54-abb8-4090-f46a-c7d907f1005a","scrolled":true},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["import matplotlib.pyplot as plt\n","plt.plot(df_processed['views'])\n","plt.show()"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"CDnawR1U8KYx","executionInfo":{"status":"ok","timestamp":1654311834187,"user_tz":-540,"elapsed":330,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["n1 = np.percentile(df_processed['views'].values, 25)\n","n2 = np.percentile(df_processed['views'].values,50)\n","n3 = np.percentile(df_processed['views'].values, 75)\n"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"bOmKrtEY8KYx","executionInfo":{"status":"ok","timestamp":1654311842372,"user_tz":-540,"elapsed":347,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["### preprocess views-levels\n","def ViewPreproc2(data):\n","    if data <= n1:\n","        label = 0\n","    elif n1 < data <= n2:\n","        label = 1\n","    elif n2 < data <= n3:\n","        label = 2\n","    elif data > n3:\n","        label = 3\n","    return label\n","\n","df_viewlv = []\n","for view in df_processed['views']:\n","    label = ViewPreproc2(view)\n","    df_viewlv.append(label)\n","df_processed['view_lv'] = df_viewlv"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"0Hnwemy9VAo_","executionInfo":{"status":"ok","timestamp":1654311844818,"user_tz":-540,"elapsed":490,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["n1 = np.percentile(df_processed['publish_time'].values, 25)\n","n2 = np.percentile(df_processed['publish_time'].values,50)\n","n3 = np.percentile(df_processed['publish_time'].values, 75)"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"ScMGjKhZVGF2","executionInfo":{"status":"ok","timestamp":1654311846569,"user_tz":-540,"elapsed":345,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["### preprocess views-levels\n","def ViewPreproc2(data):\n","    if data <= n1:\n","        label = 0\n","    elif n1 < data <= n2:\n","        label = 1\n","    elif n2 < data <= n3:\n","        label = 2\n","    elif data > n3:\n","        label = 3\n","    return label\n","\n","df_timelv = []\n","for time in df_processed['publish_time']:\n","    label = ViewPreproc2(time)\n","    df_timelv.append(label)\n","df_processed['time_lv'] = df_timelv"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":554},"executionInfo":{"elapsed":338,"status":"ok","timestamp":1654311853455,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"FCyYew0CV4Ou","outputId":"320184b8-7839-4f71-c465-be9a6a17c266"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["       label                                          title_new  emoji  \\\n","0          0            [사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]  False   \n","1          0                                   [할인, 뷰마, 박스, 공개]   True   \n","2          0          [요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]  False   \n","3          0                          [배우, 잠적, 이유, 뷰티, 사이드, 요약]  False   \n","4          0  [청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...  False   \n","...      ...                                                ...    ...   \n","26737      4                        [아줌마, 브이, 로그, 주부, 일상, 네일아트]  False   \n","26738      4  [미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...  False   \n","26739      4  [미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...  False   \n","26740      4                                                 []  False   \n","26741      4                      [미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]  False   \n","\n","          views       subs   channel_name  publish_time  view_lv  time_lv  \n","0      804394.0  1960000.0             고몽        202205        3        3  \n","1      199959.0   352000.0          뷰티마우스        202205        2        3  \n","2       61394.0   159000.0  옥뷰티 OK Beauty        202205        2        3  \n","3        7568.0   250000.0   DRAMA Voyage        202205        1        3  \n","4      193907.0   133000.0  뷰티숨BEAUTYSOOM        202205        2        3  \n","...         ...        ...            ...           ...      ...      ...  \n","26737   93572.0   102000.0  양아치TV AUNT TV        202002        2        0  \n","26738    1208.0      522.0      예슬 Serena        202002        0        0  \n","26739     950.0      522.0      예슬 Serena        202002        0        0  \n","26740  162171.0  1070000.0       Tesla US        202002        2        0  \n","26741     945.0      522.0      예슬 Serena        202002        0        0  \n","\n","[26742 rows x 9 columns]"],"text/html":["\n","  <div id=\"df-b856e9e9-40ef-46c7-b424-48fc68a577fe\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>label</th>\n","      <th>title_new</th>\n","      <th>emoji</th>\n","      <th>views</th>\n","      <th>subs</th>\n","      <th>channel_name</th>\n","      <th>publish_time</th>\n","      <th>view_lv</th>\n","      <th>time_lv</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>[사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]</td>\n","      <td>False</td>\n","      <td>804394.0</td>\n","      <td>1960000.0</td>\n","      <td>고몽</td>\n","      <td>202205</td>\n","      <td>3</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>[할인, 뷰마, 박스, 공개]</td>\n","      <td>True</td>\n","      <td>199959.0</td>\n","      <td>352000.0</td>\n","      <td>뷰티마우스</td>\n","      <td>202205</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>[요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]</td>\n","      <td>False</td>\n","      <td>61394.0</td>\n","      <td>159000.0</td>\n","      <td>옥뷰티 OK Beauty</td>\n","      <td>202205</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>[배우, 잠적, 이유, 뷰티, 사이드, 요약]</td>\n","      <td>False</td>\n","      <td>7568.0</td>\n","      <td>250000.0</td>\n","      <td>DRAMA Voyage</td>\n","      <td>202205</td>\n","      <td>1</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>[청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...</td>\n","      <td>False</td>\n","      <td>193907.0</td>\n","      <td>133000.0</td>\n","      <td>뷰티숨BEAUTYSOOM</td>\n","      <td>202205</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>26737</th>\n","      <td>4</td>\n","      <td>[아줌마, 브이, 로그, 주부, 일상, 네일아트]</td>\n","      <td>False</td>\n","      <td>93572.0</td>\n","      <td>102000.0</td>\n","      <td>양아치TV AUNT TV</td>\n","      <td>202002</td>\n","      <td>2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>26738</th>\n","      <td>4</td>\n","      <td>[미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...</td>\n","      <td>False</td>\n","      <td>1208.0</td>\n","      <td>522.0</td>\n","      <td>예슬 Serena</td>\n","      <td>202002</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>26739</th>\n","      <td>4</td>\n","      <td>[미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...</td>\n","      <td>False</td>\n","      <td>950.0</td>\n","      <td>522.0</td>\n","      <td>예슬 Serena</td>\n","      <td>202002</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>26740</th>\n","      <td>4</td>\n","      <td>[]</td>\n","      <td>False</td>\n","      <td>162171.0</td>\n","      <td>1070000.0</td>\n","      <td>Tesla US</td>\n","      <td>202002</td>\n","      <td>2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>26741</th>\n","      <td>4</td>\n","      <td>[미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]</td>\n","      <td>False</td>\n","      <td>945.0</td>\n","      <td>522.0</td>\n","      <td>예슬 Serena</td>\n","      <td>202002</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>26742 rows × 9 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b856e9e9-40ef-46c7-b424-48fc68a577fe')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b856e9e9-40ef-46c7-b424-48fc68a577fe button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b856e9e9-40ef-46c7-b424-48fc68a577fe');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":10}],"source":["df_processed"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"O4FLwqqM8KYx","executionInfo":{"status":"ok","timestamp":1654311867144,"user_tz":-540,"elapsed":340,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["from sklearn.preprocessing import LabelEncoder\n","le = LabelEncoder()\n","df_processed['emoji_label'] = le.fit_transform(df_processed['emoji'])"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":936},"executionInfo":{"elapsed":587,"status":"ok","timestamp":1654311869611,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"VciLpLkB8KYy","outputId":"bbeba416-ae84-4eee-da67-a62d658ca356"},"outputs":[{"output_type":"display_data","data":{"text/plain":["       label                                          title_new  emoji  \\\n","0          0            [사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]  False   \n","1          0                                   [할인, 뷰마, 박스, 공개]   True   \n","2          0          [요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]  False   \n","3          0                          [배우, 잠적, 이유, 뷰티, 사이드, 요약]  False   \n","4          0  [청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...  False   \n","...      ...                                                ...    ...   \n","26737      4                        [아줌마, 브이, 로그, 주부, 일상, 네일아트]  False   \n","26738      4  [미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...  False   \n","26739      4  [미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...  False   \n","26740      4                                                 []  False   \n","26741      4                      [미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]  False   \n","\n","          views       subs   channel_name  publish_time  view_lv  time_lv  \\\n","0      804394.0  1960000.0             고몽        202205        3        3   \n","1      199959.0   352000.0          뷰티마우스        202205        2        3   \n","2       61394.0   159000.0  옥뷰티 OK Beauty        202205        2        3   \n","3        7568.0   250000.0   DRAMA Voyage        202205        1        3   \n","4      193907.0   133000.0  뷰티숨BEAUTYSOOM        202205        2        3   \n","...         ...        ...            ...           ...      ...      ...   \n","26737   93572.0   102000.0  양아치TV AUNT TV        202002        2        0   \n","26738    1208.0      522.0      예슬 Serena        202002        0        0   \n","26739     950.0      522.0      예슬 Serena        202002        0        0   \n","26740  162171.0  1070000.0       Tesla US        202002        2        0   \n","26741     945.0      522.0      예슬 Serena        202002        0        0   \n","\n","       emoji_label                                          title_str  \n","0                0                      사람 번만 사람 레전드 꿀잼 드라마 뷰티 사이드 보기  \n","1                1                                        할인 뷰마 박스 공개  \n","2                0                   요즘 프로필 메이크업 연예인 프로필 메이크업 역대 메이크업  \n","3                0                                 배우 잠적 이유 뷰티 사이드 요약  \n","4                0  청담동 메이크업 추천 그대로 구매 지속 파운데이션 가닥 속눈썹 고급 하이 라이터 웨...  \n","...            ...                                                ...  \n","26737            0                               아줌마 브이 로그 주부 일상 네일아트  \n","26738            0            미국 유학생 일상 브이 로그 학교 브이 로그 코딩 수업 학교 스킨 케어  \n","26739            0  미국 유학생 일상 브이 로그 주말 브이 로그 요리 해먹 마트 일상 마스크 마트 중국...  \n","26740            0                                                     \n","26741            0                             미국 미대 크리 겟레디윗미 프라이탁 불시  \n","\n","[26742 rows x 11 columns]"],"text/html":["\n","  <div id=\"df-b3806258-2bfe-443b-af19-600da02ceab5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>label</th>\n","      <th>title_new</th>\n","      <th>emoji</th>\n","      <th>views</th>\n","      <th>subs</th>\n","      <th>channel_name</th>\n","      <th>publish_time</th>\n","      <th>view_lv</th>\n","      <th>time_lv</th>\n","      <th>emoji_label</th>\n","      <th>title_str</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>[사람, 번만, 사람, 레전드, 꿀잼, 드라마, 뷰티, 사이드, 보기]</td>\n","      <td>False</td>\n","      <td>804394.0</td>\n","      <td>1960000.0</td>\n","      <td>고몽</td>\n","      <td>202205</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>사람 번만 사람 레전드 꿀잼 드라마 뷰티 사이드 보기</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>[할인, 뷰마, 박스, 공개]</td>\n","      <td>True</td>\n","      <td>199959.0</td>\n","      <td>352000.0</td>\n","      <td>뷰티마우스</td>\n","      <td>202205</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>할인 뷰마 박스 공개</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>[요즘, 프로필, 메이크업, 연예인, 프로필, 메이크업, 역대, 메이크업]</td>\n","      <td>False</td>\n","      <td>61394.0</td>\n","      <td>159000.0</td>\n","      <td>옥뷰티 OK Beauty</td>\n","      <td>202205</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>요즘 프로필 메이크업 연예인 프로필 메이크업 역대 메이크업</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>[배우, 잠적, 이유, 뷰티, 사이드, 요약]</td>\n","      <td>False</td>\n","      <td>7568.0</td>\n","      <td>250000.0</td>\n","      <td>DRAMA Voyage</td>\n","      <td>202205</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>배우 잠적 이유 뷰티 사이드 요약</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>[청담동, 메이크업, 추천, 그대로, 구매, 지속, 파운데이션, 가닥, 속눈썹, 고...</td>\n","      <td>False</td>\n","      <td>193907.0</td>\n","      <td>133000.0</td>\n","      <td>뷰티숨BEAUTYSOOM</td>\n","      <td>202205</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>청담동 메이크업 추천 그대로 구매 지속 파운데이션 가닥 속눈썹 고급 하이 라이터 웨...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>26737</th>\n","      <td>4</td>\n","      <td>[아줌마, 브이, 로그, 주부, 일상, 네일아트]</td>\n","      <td>False</td>\n","      <td>93572.0</td>\n","      <td>102000.0</td>\n","      <td>양아치TV AUNT TV</td>\n","      <td>202002</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>아줌마 브이 로그 주부 일상 네일아트</td>\n","    </tr>\n","    <tr>\n","      <th>26738</th>\n","      <td>4</td>\n","      <td>[미국, 유학생, 일상, 브이, 로그, 학교, 브이, 로그, 코딩, 수업, 학교, ...</td>\n","      <td>False</td>\n","      <td>1208.0</td>\n","      <td>522.0</td>\n","      <td>예슬 Serena</td>\n","      <td>202002</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>미국 유학생 일상 브이 로그 학교 브이 로그 코딩 수업 학교 스킨 케어</td>\n","    </tr>\n","    <tr>\n","      <th>26739</th>\n","      <td>4</td>\n","      <td>[미국, 유학생, 일상, 브이, 로그, 주말, 브이, 로그, 요리, 해먹, 마트, ...</td>\n","      <td>False</td>\n","      <td>950.0</td>\n","      <td>522.0</td>\n","      <td>예슬 Serena</td>\n","      <td>202002</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>미국 유학생 일상 브이 로그 주말 브이 로그 요리 해먹 마트 일상 마스크 마트 중국...</td>\n","    </tr>\n","    <tr>\n","      <th>26740</th>\n","      <td>4</td>\n","      <td>[]</td>\n","      <td>False</td>\n","      <td>162171.0</td>\n","      <td>1070000.0</td>\n","      <td>Tesla US</td>\n","      <td>202002</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td></td>\n","    </tr>\n","    <tr>\n","      <th>26741</th>\n","      <td>4</td>\n","      <td>[미국, 미대, 크리, 겟레디윗미, 프라이탁, 불시]</td>\n","      <td>False</td>\n","      <td>945.0</td>\n","      <td>522.0</td>\n","      <td>예슬 Serena</td>\n","      <td>202002</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>미국 미대 크리 겟레디윗미 프라이탁 불시</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>26742 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b3806258-2bfe-443b-af19-600da02ceab5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b3806258-2bfe-443b-af19-600da02ceab5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b3806258-2bfe-443b-af19-600da02ceab5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["from sklearn.feature_extraction.text import CountVectorizer # frequency based DTM\n","from sklearn.feature_extraction.text import TfidfVectorizer # tf-idf based DTM\n","\n","### make data to list of strings again\n","title_filtered = []\n","for title in df_processed['title_new']:\n","    title_str =' '.join(title)\n","    title_filtered.append(title_str) # list of docs, doc 은 단어들로 구성이 된 string data\n","# 불필요한 단어들을 제거하고 난후 DTM로 변환하기 위해 다시 list of strings의 형태로 변환\n","df_processed['title_str']=title_filtered\n","display(df_processed)"]},{"cell_type":"markdown","metadata":{"id":"cSW618GM8KYy"},"source":["### Vectorization ver 1."]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1575,"status":"ok","timestamp":1654311874613,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"QGuq3U-g8KYz","outputId":"fc149b81-0d70-430e-a4f9-52aca8699f6e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(26742, 1500)"]},"metadata":{},"execution_count":13}],"source":["tfidf_vectorizer2 = TfidfVectorizer(min_df=1, ngram_range=(1,2), max_features = 1500)\n","tfidf_features2 = tfidf_vectorizer2.fit_transform(df_processed['title_str'])\n","tfidf_features2 = np.array(tfidf_features2.todense())\n","tfidf_features2.shape"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"hYMS7qJC8KYz","executionInfo":{"status":"ok","timestamp":1654311877422,"user_tz":-540,"elapsed":348,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["tfidf2 = pd.DataFrame(tfidf_features2)\n","X = pd.concat([tfidf2, df_processed[['subs','emoji_label','publish_time']]], axis = 1)\n","y = df_processed['view_lv']"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1235,"status":"ok","timestamp":1654311887471,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"nCUx_0448KYz","outputId":"2a751a73-36b7-4a0c-f9eb-fef23e6bac3a"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n","/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n"]}],"source":["from sklearn.preprocessing import MaxAbsScaler\n","max_scaler = MaxAbsScaler()\n","\n","X_sc = scaler.fit_transform(X)"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":333,"status":"ok","timestamp":1654311889539,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"ionlj6V48KYz","outputId":"da274b26-c0d6-426b-a0da-115623b53e6c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["26742"]},"metadata":{},"execution_count":16}],"source":["len(X_sc)"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"0Sx3MOcZ8KYz","executionInfo":{"status":"ok","timestamp":1654311891652,"user_tz":-540,"elapsed":755,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}}},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","X_train, X_test, y_train, y_test = train_test_split(X_sc, y, \n","                                                    test_size=0.1, \n","                                                    random_state=0, \n","                                                    stratify=y)"]},{"cell_type":"code","source":["X_sc2 = max_scaler.fit_transform(X)\n","X_train2, X_test2, y_train2, y_test2 = train_test_split(X_sc2, y, \n","                                                    test_size=0.1, \n","                                                    random_state=0, \n","                                                    stratify=y)\n","\n","rnd_clf2 = RandomForestClassifier(n_estimators=100, max_features='sqrt', \n","                                 max_depth = None, min_samples_split=2,\n","                                 n_jobs=-1)\n","rnd_clf2.fit(X_train2, y_train2)\n","y_rnd2 = rnd_clf2.predict(X_test2)\n","accuracy_score(y_test2, y_rnd2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XF61DW06rUp2","executionInfo":{"status":"ok","timestamp":1654312065531,"user_tz":-540,"elapsed":22833,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"}},"outputId":"75a69c4a-190a-4817-8355-72cfc2787f7f"},"execution_count":19,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n","/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:1692: FutureWarning: Feature names only support names that are all strings. Got feature names with dtypes: ['int', 'str']. An error will be raised in 1.2.\n","  FutureWarning,\n"]},{"output_type":"execute_result","data":{"text/plain":["0.7536448598130842"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22241,"status":"ok","timestamp":1654311915444,"user":{"displayName":"김서진(상경대학 응용통계학과)","userId":"15599389639595271672"},"user_tz":-540},"id":"Zy7K9DbvBdey","outputId":"8389081c-5f34-4cf2-cc65-155873ff8384"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.7476635514018691"]},"metadata":{},"execution_count":18}],"source":["from sklearn.ensemble import RandomForestClassifier\n","from sklearn.metrics import accuracy_score\n","rnd_clf = RandomForestClassifier(n_estimators=100, max_features='sqrt', \n","                                 max_depth = None, min_samples_split=2,\n","                                 n_jobs=-1)\n","rnd_clf.fit(X_train, y_train)\n","y_rnd = rnd_clf.predict(X_test)\n","accuracy_score(y_test, y_rnd)"]},{"cell_type":"code","source":[""],"metadata":{"id":"8xdwpsPwCYKl"},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"name":"Regression_publishtime.ipynb의 사본","provenance":[{"file_id":"1pK6vG09UVpCwXBxzrQzAtccqNXR8V_ce","timestamp":1654311690148}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"}},"nbformat":4,"nbformat_minor":0}